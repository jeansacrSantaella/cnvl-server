"use strict";(self.webpackChunksarc=self.webpackChunksarc||[]).push([[366],{7372:(R,g,l)=>{l.d(g,{M:()=>u});class u{constructor(){this.nombre="",this.fechaRegistro=new Date,this.id=0}}},6445:(R,g,l)=>{l.d(g,{B:()=>f});var u=l(1571),r=l(6511);let f=(()=>{class p{constructor(d){this._rolesGateway=d}getById(d){return this._rolesGateway.getById(d)}getAll(){return this._rolesGateway.getAll()}}return p.\u0275fac=function(d){return new(d||p)(u.LFG(r.W))},p.\u0275prov=u.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},9119:(R,g,l)=>{l.d(g,{O:()=>f});var u=l(1571),r=l(6511);let f=(()=>{class p{constructor(d){this._rolesGateway=d}deleteById(d){return this._rolesGateway.deleteById(d)}update(d){return this._rolesGateway.update(d)}create(d){return this._rolesGateway.create(d)}}return p.\u0275fac=function(d){return new(d||p)(u.LFG(r.W))},p.\u0275prov=u.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},5366:(R,g,l)=>{l.r(g),l.d(g,{RolesModule:()=>S});var u=l(6895),r=l(433),f=l(646),p=l(8675),h=l(4004),d=l(5226),c=l.n(d),b=l(7372),e=l(1571),_=l(1165),C=l(9119);function v(o,i){1&o&&(e.TgZ(0,"span",15),e._uU(1,"* Campo requerido"),e.qZA())}let Z=(()=>{class o{constructor(t,s){this.modalService=t,this._updateRoleUseCases=s,this.role=new b.M,this.isReady=!1}createRole(){""!==this.role?.nombre?(this.role.activo=!0,this.response$=this._updateRoleUseCases.create(this.role),this.response$.subscribe({next:t=>{this.isReady=!0,c().fire("","\xa1Rol creado exitosamente!","success"),this.close()},error:t=>{c().close(),404==t.status?c().fire("","Los datos ingresados son incorrectos.","error"):501==t.status?c().fire("","Error al registrar, el rol ya existe","error"):0==t.status&&c().fire("","Validar servicio activo","error")}})):c().fire("","Los datos ingresados son incorrectos.","error")}close(){this.modalService.dismissAll()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(_.FF),e.Y36(C.O))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-roles-create"]],decls:20,vars:2,consts:[["data-target","#modal",1,"modal-content"],[1,"modal-header"],[1,"modal-title","text-primary"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit"],["ngformUpdate",""],[1,"col-12","label-left"],["for",""],["type","text","name","nombre","id","nombre","autofocus","","required","",1,"form-control",3,"ngModel","ngModelChange"],["nombre","ngModel"],["class","text-danger",4,"ngIf"],[1,"modal-footer","btn-group"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary"],[1,"text-danger"]],template:function(t,s){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),e._uU(3,"Nuevo Rol"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return s.close()}),e.qZA()(),e.TgZ(5,"div",4)(6,"form",5,6),e.NdJ("ngSubmit",function(){return s.createRole()}),e.TgZ(8,"div",7)(9,"label",8),e._uU(10,"Nombre del rol"),e.qZA()(),e.TgZ(11,"div",7)(12,"input",9,10),e.NdJ("ngModelChange",function(a){return s.role.nombre=a}),e.qZA(),e.YNc(14,v,2,0,"span",11),e.qZA(),e.TgZ(15,"div",12)(16,"button",13),e.NdJ("click",function(){return s.close()}),e._uU(17," Cancelar "),e.qZA(),e.TgZ(18,"button",14),e._uU(19,"Guardar"),e.qZA()()()()()),2&t){const n=e.MAs(13);e.xp6(12),e.Q6J("ngModel",s.role.nombre),e.xp6(2),e.Q6J("ngIf",null==n.errors?null:n.errors.required)}},dependencies:[u.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.On,r.F],encapsulation:2}),o})();var y=l(6445);function x(o,i){1&o&&(e.TgZ(0,"span",15),e._uU(1,"* Campo requerido"),e.qZA())}let A=(()=>{class o{constructor(t,s,n){this.modalService=t,this._updateRoleUseCases=s,this._getRoleUseCases=n,this.roleRequest=new b.M,this.isReady=!1}ngOnInit(){this.getRoleById()}getRoleById(){this._getRoleUseCases.getById(Number(this.roleId)).subscribe(s=>{this.roleRequest=s,this.isReady=!0})}updateRole(){""!==this.roleRequest?.nombre?(this.loadingDialog(),this._updateRoleUseCases.update(this.roleRequest).subscribe({next:s=>{c().close(),this.isReady=!0,c().fire("","\xa1Rol editado exitosamente!","success"),this.close()},error:s=>{c().close(),0==s.status&&c().fire("","Validar servicio activo","error")}})):c().fire("","Los datos ingresados son incorrectos.","error")}close(){this.modalService.dismissAll("reason")}loadingDialog(){c().fire({imageUrl:"assets/img/loader.gif",imageWidth:"100px",showConfirmButton:!1,allowOutsideClick:!1})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(_.FF),e.Y36(C.O),e.Y36(y.B))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-roles-edit"]],decls:20,vars:2,consts:[["data-target","#modal",1,"modal-content"],[1,"modal-header"],[1,"modal-title","text-primary"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit"],["ngformUpdate",""],[1,"col-12","label-left"],["for",""],["type","text","name","nombre","id","nombre","autofocus","","required","",1,"form-control",3,"ngModel","ngModelChange"],["nombre","ngModel"],["class","text-danger",4,"ngIf"],[1,"modal-footer","btn-group"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary"],[1,"text-danger"]],template:function(t,s){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),e._uU(3,"Modificar Rol"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return s.close()}),e.qZA()(),e.TgZ(5,"div",4)(6,"form",5,6),e.NdJ("ngSubmit",function(){return s.updateRole()}),e.TgZ(8,"div",7)(9,"label",8),e._uU(10,"Nombre del rol"),e.qZA()(),e.TgZ(11,"div",7)(12,"input",9,10),e.NdJ("ngModelChange",function(a){return s.roleRequest.nombre=a}),e.qZA(),e.YNc(14,x,2,0,"span",11),e.qZA(),e.TgZ(15,"div",12)(16,"button",13),e.NdJ("click",function(){return s.close()}),e._uU(17," Cancelar "),e.qZA(),e.TgZ(18,"button",14),e._uU(19,"Guardar"),e.qZA()()()()()),2&t){const n=e.MAs(13);e.xp6(12),e.Q6J("ngModel",s.roleRequest.nombre),e.xp6(2),e.Q6J("ngIf",null==n.errors?null:n.errors.required)}},dependencies:[u.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.On,r.F],encapsulation:2}),o})();var T=l(8462);const U=["*"];let w=(()=>{class o{constructor(){this.title=""}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-card"]],inputs:{title:"title"},ngContentSelectors:U,decls:2,vars:0,consts:[[1,"wrapper","flex-grow-1"]],template:function(t,s){1&t&&(e.F$t(),e.TgZ(0,"div",0),e.Hsn(1),e.qZA())},styles:[".card-container[_ngcontent-%COMP%]{width:100%;height:100%}.card-app[_ngcontent-%COMP%]{width:97%;height:95%;padding:20px}.row-title[_ngcontent-%COMP%]{text-align:center}.row-content[_ngcontent-%COMP%]{margin-top:15px}"]}),o})();function M(o,i){1&o&&(e.TgZ(0,"div"),e._UZ(1,"img",9),e.qZA()),2&o&&(e.xp6(1),e.Q6J("src","assets/img/loader.gif",e.LSH))}function J(o,i){1&o&&(e.TgZ(0,"tbody")(1,"td",18),e._uU(2,"Sin resultados"),e.qZA()())}function L(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"ngb-highlight",20),e.qZA(),e.TgZ(5,"td")(6,"button",21),e.NdJ("click",function(){const a=e.CHM(t).$implicit,m=e.oxw(3);return e.KtG(m.editById(a.id))}),e._UZ(7,"em",22),e.qZA(),e.TgZ(8,"button",21),e.NdJ("click",function(){const a=e.CHM(t).$implicit,m=e.oxw(3);return e.KtG(m.deleteById(a))}),e._UZ(9,"em",23),e.qZA()()()}if(2&o){const t=i.$implicit,s=e.oxw(3);e.xp6(2),e.hij(" ",t.idList," "),e.xp6(2),e.Q6J("result",t.nombre)("term",s.filterAll.value)}}function I(o,i){if(1&o&&(e.TgZ(0,"tbody"),e.YNc(1,L,10,3,"tr",19),e.ALo(2,"slice"),e.ALo(3,"async"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.Dn7(2,1,e.lcZ(3,5,t.source$),(t.page-1)*t.pageSize,t.page*t.pageSize))}}function B(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",10)(2,"div",11)(3,"table",12)(4,"thead",13)(5,"tr")(6,"th",14)(7,"div",15),e._uU(8,"#"),e.qZA()(),e.TgZ(9,"th",14)(10,"div",15),e._uU(11,"Rol"),e.qZA()(),e.TgZ(12,"th",14)(13,"div",15),e._uU(14,"Gesti\xf3n"),e.qZA()()()(),e.YNc(15,J,3,0,"tbody",8),e.ALo(16,"async"),e.YNc(17,I,4,7,"tbody",8),e.ALo(18,"async"),e.qZA()()(),e.TgZ(19,"div",16)(20,"ngb-pagination",17),e.NdJ("pageChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.page=n)}),e.ALo(21,"async"),e.qZA()()()}if(2&o){const t=e.oxw();let s,n,a;e.xp6(15),e.Q6J("ngIf",0==(null==(s=e.lcZ(16,6,t.source$))?null:s.length)),e.xp6(2),e.Q6J("ngIf",0!==(null==(n=e.lcZ(18,8,t.source$))?null:n.length)),e.xp6(3),e.Q6J("collectionSize",null!==(a=null==(a=e.lcZ(21,10,t.source$))?null:a.length)&&void 0!==a?a:0)("page",t.page)("pageSize",t.pageSize)("maxSize",2)}}const O=[{path:"",children:[{path:"show",component:(()=>{class o{constructor(t,s,n,a){this.modalService=t,this._getRoleUseCases=s,this._updateRoleUseCases=n,this.ROLES=[],this.page=0,this.pageSize=10,this.filterName=new r.NI("",{nonNullable:!0}),this.filterAll=new r.NI("",{nonNullable:!0}),this.pipe=a,this.isReady=!1}ngOnInit(){this.getAllRoles()}getAllRoles(){this.isReady=!1,this._getRoleUseCases.getAll().subscribe(s=>{s.forEach((n,a)=>{n.idList=a+1}),this.ROLES=s,this.isReady=!0,this.source$=this.filterAll.valueChanges.pipe((0,p.O)(""),(0,h.U)(n=>this.search(n,this.pipe)))})}search(t,s){return this.ROLES.filter(n=>{const a=t.toLowerCase();return n.nombre.toLowerCase().includes(a)})}editById(t){const s=this.modalService.open(A,{fullscreen:"xl"});s.componentInstance.roleId=t,s.result.then(()=>{},n=>{this.isReady=!1,this.getAllRoles()})}createRole(){this.modalService.open(Z,{fullscreen:"xl"}).result.then(()=>{},s=>{this.isReady=!1,this.getAllRoles()})}deleteById(t){c().fire({text:"\xbfDesea eliminar el rol?",title:"Eliminar Rol",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",reverseButtons:!0,showCloseButton:!0}).then(s=>{s.isConfirmed&&this._updateRoleUseCases.update({nombre:t.nombre,fechaRegistro:t.fechaRegistro,id:t.id,activo:!1}).subscribe({next:m=>{c().close(),this.isReady=!0,c().fire("","\xa1Rol eliminado exitosamente!","success"),this.isReady=!1,this.getAllRoles()},error:m=>{c().close(),500==m.status?c().fire("","No se puede eliminar el rol ya que existen usuarios asignados a este.","error"):404==m.status?c().fire("",`${m.error.descripcion}`,"error"):0==m.status&&c().fire("","Validar servicio activo","error")}})})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(_.FF),e.Y36(y.B),e.Y36(C.O),e.Y36(u.JJ))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-roles-list"]],decls:12,vars:4,consts:[[3,"showBack"],[1,"wrapper","flex-grow-1"],[1,"d-flex","flex-row","justify-content-between"],[1,"d-flex","mt-auto","p-2","flex-row","align-items-center","w-100"],["for","search",1,"p-2"],["type","text",1,"form-control",3,"formControl"],[1,"p-2","w-100","justify-content-end","d-flex"],["type","button",1,"btn","btn-primary",3,"click"],[4,"ngIf"],["alt","Logo",1,"img-logo",2,"height","100%",3,"src"],[1,"d-flex","flex-column","align-items-center"],[1,"col-12","table-responsive"],["aria-describedby","Roles",1,"table","table-bordered","table-striped","text-center"],[1,"thead-inverse","table-header"],["scope","col"],[1,"col-12"],[1,"d-flex","flex-column","align-items-end"],[1,"mt-auto","p-2",3,"collectionSize","page","pageSize","maxSize","pageChange"],["colspan","5"],[4,"ngFor","ngForOf"],[3,"result","term"],[1,"btn","btn-link",3,"click"],[1,"bi","bi-pencil"],[1,"bi","bi-x-circle","text-danger"]],template:function(t,s){1&t&&(e.TgZ(0,"app-base",0)(1,"app-card",1)(2,"div",2)(3,"div",3)(4,"label",4),e._uU(5,"Buscar:"),e.qZA(),e._UZ(6,"input",5),e.qZA(),e.TgZ(7,"div",6)(8,"button",7),e.NdJ("click",function(){return s.createRole()}),e._uU(9," Nuevo Rol "),e.qZA()()(),e.YNc(10,M,2,1,"div",8),e.YNc(11,B,22,12,"div",8),e.qZA()()),2&t&&(e.Q6J("showBack",!0),e.xp6(6),e.Q6J("formControl",s.filterAll),e.xp6(4),e.Q6J("ngIf",!s.isReady),e.xp6(1),e.Q6J("ngIf",s.isReady))},dependencies:[u.sg,u.O5,T.H,_.N9,_._h,r.Fj,r.JJ,r.oH,w,u.Ov,u.OU],encapsulation:2}),o})()},{path:"**",redirectTo:"show"}]}];let E=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.Bz.forChild(O),f.Bz]}),o})();var N=l(8522);let S=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[u.ez,E,N.BaseModule,_.IJ,r.UX,r.u5]}),o})()}}]);