"use strict";(self.webpackChunksarc=self.webpackChunksarc||[]).push([[123],{6445:(M,C,u)=>{u.d(C,{B:()=>_});var c=u(1571),a=u(6511);let _=(()=>{class m{constructor(f){this._rolesGateway=f}getById(f){return this._rolesGateway.getById(f)}getAll(){return this._rolesGateway.getAll()}}return m.\u0275fac=function(f){return new(f||m)(c.LFG(a.W))},m.\u0275prov=c.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},5123:(M,C,u)=>{u.r(C),u.d(C,{UsersManagementModule:()=>ae});var c=u(6895),a=u(433),_=u(646),m=u(8675),g=u(4004),f=u(5226),d=u.n(f);class x{constructor(){this.amaterno="",this.apaterno="",this.email="",this.nombre="",this.username="",this.activo=!0,this.fechaRegistro=new Date}}var e=u(1571),b=u(2088);let U=(()=>{class s{constructor(t){this._usersGateway=t}getById(t){return this._usersGateway.getById(t)}getAll(){return this._usersGateway.getAll()}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(b.V))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Z=(()=>{class s{constructor(t){this._usersGateway=t}deleteById(t){return this._usersGateway.deleteById(t)}update(t){return this._usersGateway.update(t)}create(t){return this._usersGateway.create(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(b.V))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var A=u(6445),y=u(3346);let q=(()=>{class s{constructor(t){this._usersGateway=t}getAll(){return this._usersGateway.getAll()}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(y.G))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var T=u(8462),h=u(1165);const J=["*"];let v=(()=>{class s{constructor(){this.title=""}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-card"]],inputs:{title:"title"},ngContentSelectors:J,decls:5,vars:1,consts:[[1,"card","text-center"],[1,"card-body"],[1,"card-title","fw-bold"]],template:function(t,r){1&t&&(e.F$t(),e.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),e._uU(3),e.qZA(),e.Hsn(4),e.qZA()()),2&t&&(e.xp6(3),e.Oqu(r.title))},styles:[".card-container[_ngcontent-%COMP%]{width:100%;height:100%}.card-app[_ngcontent-%COMP%]{width:97%;height:95%;padding:20px}.row-title[_ngcontent-%COMP%]{text-align:center}.row-content[_ngcontent-%COMP%]{margin-top:15px}"]}),s})();function w(s,i){1&s&&(e.TgZ(0,"tbody")(1,"td",15),e._uU(2,"Sin resultados"),e.qZA()())}function N(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"tr",17),e.NdJ("click",function(){const o=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.rowToUser(o))}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"ngb-highlight",18),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"ngb-highlight",18),e.qZA(),e.TgZ(7,"td"),e._UZ(8,"ngb-highlight",18),e.qZA()()}if(2&s){const t=i.$implicit,r=e.oxw(2);e.xp6(2),e.hij(" ",t.id," "),e.xp6(2),e.Q6J("result",t.samaccountname)("term",r.filterAll.value),e.xp6(2),e.Q6J("result",t.commonName)("term",r.filterAll.value),e.xp6(2),e.Q6J("result",t.userPrincipal)("term",r.filterAll.value)}}function I(s,i){if(1&s&&(e.TgZ(0,"tbody"),e.YNc(1,N,9,7,"tr",16),e.ALo(2,"slice"),e.ALo(3,"async"),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.Dn7(2,1,e.lcZ(3,5,t.source$),(t.page-1)*t.pageSize,t.page*t.pageSize))}}function Q(s,i){1&s&&(e.TgZ(0,"span",41),e._uU(1,"* Campo requerido"),e.qZA())}function S(s,i){1&s&&(e.TgZ(0,"span",41),e._uU(1,"* Campo requerido"),e.qZA())}function R(s,i){1&s&&(e.TgZ(0,"span",41),e._uU(1,"* Campo requerido"),e.qZA())}function L(s,i){1&s&&(e.TgZ(0,"span",41),e._uU(1,"* Campo requerido"),e.qZA())}function F(s,i){1&s&&(e.TgZ(0,"span",41),e._uU(1,"* Campo requerido"),e.qZA())}function E(s,i){1&s&&(e.TgZ(0,"span",41),e._uU(1,"* Ingrese un usuario valido "),e.qZA())}function G(s,i){if(1&s&&(e.TgZ(0,"option",42),e._uU(1),e.qZA()),2&s){const t=i.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.nombre," ")}}function Y(s,i){1&s&&(e.TgZ(0,"span",41),e._uU(1,"* Campo requerido"),e.qZA())}function O(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"form",19,20),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.saveUser())}),e.TgZ(2,"div",21)(3,"label",22),e._uU(4,"Usuario"),e.qZA(),e.TgZ(5,"input",23,24),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.user.username=n)}),e.qZA(),e.YNc(7,Q,2,0,"span",25),e.qZA(),e.TgZ(8,"div",21)(9,"label",22),e._uU(10,"Nombre"),e.qZA(),e.TgZ(11,"input",26,27),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.user.nombre=n)}),e.qZA(),e.YNc(13,S,2,0,"span",25),e.qZA(),e.TgZ(14,"div",21)(15,"label",22),e._uU(16,"Apellido Paterno"),e.qZA(),e.TgZ(17,"input",28,29),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.user.apaterno=n)}),e.qZA(),e.YNc(19,R,2,0,"span",25),e.qZA(),e.TgZ(20,"div",21)(21,"label",22),e._uU(22,"Apellido Materno"),e.qZA(),e.TgZ(23,"input",30,31),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.user.amaterno=n)}),e.qZA(),e.YNc(25,L,2,0,"span",25),e.qZA(),e.TgZ(26,"div",21)(27,"label",22),e._uU(28,"Correo"),e.qZA(),e.TgZ(29,"input",32,33),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.user.email=n)}),e.qZA(),e.YNc(31,F,2,0,"span",25),e.YNc(32,E,2,0,"span",25),e.qZA(),e.TgZ(33,"div",21)(34,"label",22),e._uU(35,"Rol"),e.qZA(),e.TgZ(36,"select",34,35),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.user.role=n)}),e.YNc(38,G,2,2,"option",36),e.qZA(),e.YNc(39,Y,2,0,"span",25),e.qZA(),e.TgZ(40,"div",37)(41,"button",38),e._uU(42,"Cancelar"),e.qZA(),e.TgZ(43,"button",39),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.clearFields())}),e._uU(44,"Limpiar Datos"),e.qZA(),e.TgZ(45,"button",40),e._uU(46,"Guardar"),e.qZA()()()}if(2&s){const t=e.MAs(6),r=e.MAs(12),n=e.MAs(18),o=e.MAs(24),l=e.MAs(30),p=e.oxw();e.xp6(5),e.Q6J("ngModel",p.user.username),e.xp6(2),e.Q6J("ngIf",null==t.errors?null:t.errors.required),e.xp6(4),e.Q6J("ngModel",p.user.nombre),e.xp6(2),e.Q6J("ngIf",null==r.errors?null:r.errors.required),e.xp6(4),e.Q6J("ngModel",p.user.apaterno),e.xp6(2),e.Q6J("ngIf",null==n.errors?null:n.errors.required),e.xp6(4),e.Q6J("ngModel",p.user.amaterno),e.xp6(2),e.Q6J("ngIf",null==o.errors?null:o.errors.required),e.xp6(4),e.Q6J("ngModel",p.user.email)("email",!0),e.xp6(2),e.Q6J("ngIf",null==l.errors?null:l.errors.required),e.xp6(1),e.Q6J("ngIf",null==l.errors?null:l.errors.email),e.xp6(4),e.Q6J("ngModel",p.user.role),e.xp6(2),e.Q6J("ngForOf",p.roles),e.xp6(1),e.Q6J("ngIf",null==l.errors?null:l.errors.required)}}let B=(()=>{class s{constructor(t,r,n,o,l,p){this._getUserUseCases=t,this._updateUserUseCases=n,this._getRoleUseCases=o,this._getLdapUsersUseCases=l,this.router=p,this.USERS=[],this.user=new x,this.page=0,this.pageSize=10,this.filterUser=new a.NI("",{nonNullable:!0}),this.filterName=new a.NI("",{nonNullable:!0}),this.filterCorreo=new a.NI("",{nonNullable:!0}),this.filterId=new a.NI("",{nonNullable:!0}),this.filterAll=new a.NI("",{nonNullable:!0}),this.roles=[],this.pipe=r,this.isReady=!1}ngOnInit(){this.getLdapUsers(),this.getAllRoles()}getallUser(){this._getUserUseCases.getAll().subscribe(r=>{this.USERS=r,this.isReady=!0,this.source$=this.filterAll.valueChanges.pipe((0,m.O)(""),(0,g.U)(n=>this.search(n,this.pipe)))})}getAllRoles(){this.isReady=!1,this._getRoleUseCases.getAll().subscribe(r=>{this.roles=r,this.isReady=!0})}getLdapUsers(){this.isReady=!1;let t=this._getLdapUsersUseCases.getAll();this.listFilter=t,t.subscribe(r=>{r.forEach((n,o)=>{n.id=o+1}),this.USERS=r,this.isReady=!0,this.source$=this.filterAll.valueChanges.pipe((0,m.O)(""),(0,g.U)(n=>this.search(n,this.pipe)))})}saveUser(){const t=this.roles.filter(n=>n.id==this.user.role);this.user.roles=t[0],""===this.user?.email||0===this.user?.role||typeof this.user?.roles>"u"||typeof this.user?.email>"u"?d().fire("","Los datos ingresados son incorrectos.","error"):this._updateUserUseCases.create(this.user).subscribe({next:n=>{this.isReady=!0,d().fire("","\xa1Usuario creado exitosamente!","success").then(()=>{this.router.navigate(["/users-management/users"])})},error:n=>{d().close(),404==n.status?d().fire("","Los datos ingresados son incorrectos.","error"):501==n.status?d().fire("","No se puede registrar el usuario, solo se permite la edici\xf3n.","error"):0==n.status&&d().fire("","Validar servicio activo","error")}})}rowToUser(t){this.user.username=t.samaccountname;let[r,n,o]=t.commonName.split(" ");this.user.nombre=r??"",this.user.apaterno=n??"",this.user.amaterno=o??"",this.user.email=t.userPrincipal}search(t,r){return this.USERS.filter(n=>{const o=t.toLowerCase();return n.samaccountname.toLowerCase().includes(o)||n.commonName.toLowerCase().includes(o)||n.userPrincipal.toLowerCase().includes(o)})}searchName(t,r){return this.USERS.filter(n=>{const o=t.toLowerCase();return n.commonName.toLowerCase().includes(o)})}changeFilterName(){this.filterCorreo.setValue(""),this.filterUser.setValue(""),this.source$=this.filterName.valueChanges.pipe((0,m.O)(""),(0,g.U)(t=>this.searchName(t,this.pipe)))}searchUser(t,r){return this.USERS.filter(n=>{const o=t.toLowerCase();return n.samaccountname.toLowerCase().includes(o)})}changeFilterUser(){this.filterName.setValue(""),this.filterCorreo.setValue(""),this.source$=this.filterUser.valueChanges.pipe((0,m.O)(""),(0,g.U)(t=>this.searchUser(t,this.pipe)))}searchCorreo(t,r){return this.USERS.filter(n=>{const o=t.toLowerCase();return n.userPrincipal.toLowerCase().includes(o)})}changeFilterCorreo(){this.filterUser.setValue(""),this.filterName.setValue(""),this.source$=this.filterCorreo.valueChanges.pipe((0,m.O)(""),(0,g.U)(t=>this.searchCorreo(t,this.pipe)))}clearFields(){this.user=new x}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(U),e.Y36(c.JJ),e.Y36(Z),e.Y36(A.B),e.Y36(q),e.Y36(_.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-users-create"]],decls:33,vars:17,consts:[[3,"showBack"],["title","Nuevo usuario"],[1,"d-flex","justify-content-between","row"],[1,"d-flex","flex-column","col-md-6","col-xs-12"],[1,"d-flex","flex-column","align-items-end"],[1,"col-12","table-responsive"],["aria-describedby","Listado de usuarios",1,"table","table-bordered","table-striped"],[1,"thead-inverse","table-header"],["scope","col"],[1,"col-12"],["type","text",1,"form-control",3,"formControl","click"],[4,"ngIf"],[1,"mt-auto","p-2",3,"collectionSize","page","pageSize","maxSize","pageChange"],[1,"d-flex","flex-column","col-md-4","col-xs-12"],[3,"ngSubmit",4,"ngIf"],["colspan","5"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"result","term"],[3,"ngSubmit"],["ngformUpdate",""],[1,"form-group","align-items-start","d-flex","flex-column"],["for",""],["type","text","name","username","id","username","autofocus","","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["username","ngModel"],["class","text-danger",4,"ngIf"],["type","text","name","nombre","id","nombre","autofocus","","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["nombre","ngModel"],["type","text","name","apaterno","id","apaterno","autofocus","","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["apaterno","ngModel"],["type","text","name","amaterno","id","amaterno","autofocus","","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["amaterno","ngModel"],["type","email","name","email","id","email","disabled","",1,"form-control",3,"ngModel","email","ngModelChange"],["email","ngModel"],["name","rolesUser",1,"w100","form-select",3,"ngModel","ngModelChange"],["rolesUser","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"modal-footer","btn-group","py-5"],["type","button","routerLink","/users-management/users",1,"btn","btn-secondary"],["type","reset",1,"btn","text-white",2,"background","#3081b9",3,"click"],["type","submit",1,"btn","btn-primary"],[1,"text-danger"],[3,"value"]],template:function(t,r){if(1&t&&(e.TgZ(0,"app-base",0)(1,"app-card",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"table",6)(7,"thead",7)(8,"tr")(9,"th",8)(10,"div",9),e._uU(11,"#"),e.qZA()(),e.TgZ(12,"th",8)(13,"div",9),e._uU(14,"Usuario"),e.qZA(),e.TgZ(15,"input",10),e.NdJ("click",function(){return r.changeFilterUser()}),e.qZA()(),e.TgZ(16,"th",8)(17,"div",9),e._uU(18,"Nombre"),e.qZA(),e.TgZ(19,"input",10),e.NdJ("click",function(){return r.changeFilterName()}),e.qZA()(),e.TgZ(20,"th",8)(21,"div",9),e._uU(22,"Correo"),e.qZA(),e.TgZ(23,"input",10),e.NdJ("click",function(){return r.changeFilterCorreo()}),e.qZA()()()(),e.YNc(24,w,3,0,"tbody",11),e.ALo(25,"async"),e.YNc(26,I,4,7,"tbody",11),e.ALo(27,"async"),e.qZA()()(),e.TgZ(28,"div",4)(29,"ngb-pagination",12),e.NdJ("pageChange",function(o){return r.page=o}),e.ALo(30,"async"),e.qZA()()(),e.TgZ(31,"div",13),e.YNc(32,O,47,15,"form",14),e.qZA()()()()),2&t){let n,o,l;e.Q6J("showBack",!0),e.xp6(15),e.Q6J("formControl",r.filterUser),e.xp6(4),e.Q6J("formControl",r.filterName),e.xp6(4),e.Q6J("formControl",r.filterCorreo),e.xp6(1),e.Q6J("ngIf",0==(null==(n=e.lcZ(25,11,r.source$))?null:n.length)),e.xp6(2),e.Q6J("ngIf",0!==(null==(o=e.lcZ(27,13,r.source$))?null:o.length)),e.xp6(3),e.Q6J("collectionSize",null!==(l=null==(l=e.lcZ(30,15,r.source$))?null:l.length)&&void 0!==l?l:0)("page",r.page)("pageSize",r.pageSize)("maxSize",2),e.xp6(3),e.Q6J("ngIf",r.isReady)}},dependencies:[c.sg,c.O5,T.H,_.rH,h.N9,h._h,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.on,a.oH,a.On,a.F,v,c.Ov,c.OU],encapsulation:2}),s})();function H(s,i){1&s&&(e.TgZ(0,"div"),e._UZ(1,"img",7),e.qZA()),2&s&&(e.xp6(1),e.Q6J("src","assets/img/loader.gif",e.LSH))}function z(s,i){1&s&&(e.TgZ(0,"span",29),e._uU(1,"* Campo requerido"),e.qZA())}function k(s,i){1&s&&(e.TgZ(0,"span",29),e._uU(1,"* Campo requerido"),e.qZA())}function K(s,i){1&s&&(e.TgZ(0,"span",29),e._uU(1,"* Campo requerido"),e.qZA())}function $(s,i){1&s&&(e.TgZ(0,"span",29),e._uU(1,"* Campo requerido"),e.qZA())}function P(s,i){1&s&&(e.TgZ(0,"span",29),e._uU(1,"* Campo requerido"),e.qZA())}function V(s,i){1&s&&(e.TgZ(0,"span",29),e._uU(1,"* Ingrese un usuario valido "),e.qZA())}function j(s,i){if(1&s&&(e.TgZ(0,"option",30),e._uU(1),e.qZA()),2&s){const t=i.$implicit;e.Q6J("ngValue",t.id),e.xp6(1),e.hij(" ",t.nombre," ")}}function D(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"form",8,9),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.updateUser())}),e.TgZ(2,"div",10)(3,"label",11),e._uU(4,"Usuario"),e.qZA()(),e.TgZ(5,"div",10)(6,"input",12,13),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.user.username=n)}),e.qZA(),e.YNc(8,z,2,0,"span",14),e.qZA(),e.TgZ(9,"div",10)(10,"label",11),e._uU(11,"Nombre"),e.qZA()(),e.TgZ(12,"div",10)(13,"input",15,16),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.user.nombre=n)}),e.qZA(),e.YNc(15,k,2,0,"span",14),e.qZA(),e.TgZ(16,"div",10)(17,"label",11),e._uU(18,"Apellido Paterno"),e.qZA()(),e.TgZ(19,"div",10)(20,"input",17,18),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.user.apaterno=n)}),e.qZA(),e.YNc(22,K,2,0,"span",14),e.qZA(),e.TgZ(23,"div",10)(24,"label",11),e._uU(25,"Apellido Materno"),e.qZA()(),e.TgZ(26,"div",10)(27,"input",19,20),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.user.amaterno=n)}),e.qZA(),e.YNc(29,$,2,0,"span",14),e.qZA(),e.TgZ(30,"div",10)(31,"label",11),e._uU(32,"Correo"),e.qZA()(),e.TgZ(33,"div",10)(34,"input",21,22),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.user.email=n)}),e.qZA(),e.YNc(36,P,2,0,"span",14),e.YNc(37,V,2,0,"span",14),e.qZA(),e.TgZ(38,"div",10)(39,"label",11),e._uU(40,"Rol"),e.qZA()(),e.TgZ(41,"div",10)(42,"select",23,24),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.user.role=n)}),e.YNc(44,j,2,2,"option",25),e.qZA()(),e.TgZ(45,"div",26)(46,"button",27),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.close())}),e._uU(47," Cancelar "),e.qZA(),e.TgZ(48,"button",28),e._uU(49,"Guardar"),e.qZA()()()}if(2&s){const t=e.MAs(7),r=e.MAs(14),n=e.MAs(21),o=e.MAs(28),l=e.MAs(35),p=e.oxw();e.xp6(6),e.Q6J("ngModel",p.user.username),e.xp6(2),e.Q6J("ngIf",null==t.errors?null:t.errors.required),e.xp6(5),e.Q6J("ngModel",p.user.nombre),e.xp6(2),e.Q6J("ngIf",null==r.errors?null:r.errors.required),e.xp6(5),e.Q6J("ngModel",p.user.apaterno),e.xp6(2),e.Q6J("ngIf",null==n.errors?null:n.errors.required),e.xp6(5),e.Q6J("ngModel",p.user.amaterno),e.xp6(2),e.Q6J("ngIf",null==o.errors?null:o.errors.required),e.xp6(5),e.Q6J("ngModel",p.user.email)("email",!0),e.xp6(2),e.Q6J("ngIf",null==l.errors?null:l.errors.required),e.xp6(1),e.Q6J("ngIf",null==l.errors?null:l.errors.email),e.xp6(5),e.Q6J("ngModel",p.user.role),e.xp6(2),e.Q6J("ngForOf",p.roles)}}let W=(()=>{class s{constructor(t,r,n,o){this.modalService=t,this._getUserUseCases=r,this._updateUserUseCases=n,this._getRoleUseCases=o,this.user={},this.roles=[],this.isReady=!1}ngOnInit(){this.getUserById(Number(this.userId)),this.getAllRoles()}getUserById(t){this.isReady=!1,this.response$=this._getUserUseCases.getById(t),this.response$.subscribe(r=>{this.user=r,this.user.role=r.roles.id,this.isReady=!0})}getAllRoles(){this.isReady=!1,this._getRoleUseCases.getAll().subscribe(r=>{this.roles=r,this.isReady=!0})}updateUser(){if(""===this.user?.email||0===this.user?.role)return void d().fire("","Los datos ingresados son incorrectos.","error");d().fire({imageUrl:"assets/img/loader.gif",imageWidth:"100px",showConfirmButton:!1,allowOutsideClick:!1});const t=this.roles.filter(o=>o.id===this.user.role);this._updateUserUseCases.update({amaterno:this.user.amaterno??"",apaterno:this.user.apaterno??"",email:this.user.email,nombre:this.user.nombre??"",username:this.user.username,roles:t[0],id:this.userId,activo:!0}).subscribe({next:o=>{d().close(),this.isReady=!0,d().fire("","\xa1Usuario editado exitosamente!","success"),this.close()},error:o=>{d().close(),0==o.status&&d().fire("","Validar servicio activo","error")}})}close(){this.modalService.dismissAll()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(h.FF),e.Y36(U),e.Y36(Z),e.Y36(A.B))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-users-edit"]],decls:8,vars:2,consts:[["data-target","#modal",1,"modal-content"],[1,"modal-header"],[1,"modal-title","text-primary"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[4,"ngIf"],[3,"ngSubmit",4,"ngIf"],["alt","Logo",1,"img-logo",2,"height","100%",3,"src"],[3,"ngSubmit"],["ngformUpdate",""],[1,"col-12","label-left"],["for",""],["type","text","name","username","id","username","autofocus","","required","","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["username","ngModel"],["class","text-danger",4,"ngIf"],["type","text","name","nombre","id","nombre","autofocus","","required","","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["nombre","ngModel"],["type","text","name","apaterno","id","apaterno","autofocus","","required","","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["apaterno","ngModel"],["type","text","name","amaterno","id","amaterno","autofocus","","required","","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["amaterno","ngModel"],["type","email","name","email","id","email","autofocus","","required","","disabled","",1,"form-control",3,"ngModel","email","ngModelChange"],["email","ngModel"],["name","rolesUser",1,"w100","form-select",3,"ngModel","ngModelChange"],["rolesUser","ngModel"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"modal-footer","btn-group"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary"],[1,"text-danger"],[3,"ngValue"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),e._uU(3,"Modificar Usuario"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return r.close()}),e.qZA()(),e.TgZ(5,"div",4),e.YNc(6,H,2,1,"div",5),e.YNc(7,D,50,14,"form",6),e.qZA()()),2&t&&(e.xp6(6),e.Q6J("ngIf",!r.isReady),e.xp6(1),e.Q6J("ngIf",r.isReady))},dependencies:[c.sg,c.O5,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.Q7,a.on,a.On,a.F],encapsulation:2}),s})();function X(s,i){1&s&&(e.TgZ(0,"div"),e._UZ(1,"img",9),e.qZA()),2&s&&(e.xp6(1),e.Q6J("src","assets/img/loader.gif",e.LSH))}function ee(s,i){1&s&&(e.TgZ(0,"tbody")(1,"td",17),e._uU(2,"Sin resultados"),e.qZA()())}function te(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"ngb-highlight",19),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"ngb-highlight",19)(7,"ngb-highlight",20)(8,"ngb-highlight",19),e.qZA(),e.TgZ(9,"td"),e._UZ(10,"ngb-highlight",19),e.qZA(),e.TgZ(11,"td"),e._UZ(12,"ngb-highlight",19),e.qZA(),e.TgZ(13,"td")(14,"button",21),e.NdJ("click",function(){const o=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.open(o.id))}),e._UZ(15,"em",22),e.qZA(),e.TgZ(16,"button",21),e.NdJ("click",function(){const o=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.deleteById(o))}),e._UZ(17,"em",23),e.qZA()()()}if(2&s){const t=i.$implicit,r=e.oxw(3);e.xp6(2),e.hij(" ",t.idList," "),e.xp6(2),e.Q6J("result",t.username)("term",r.filterAll.value),e.xp6(2),e.Q6J("result",t.nombre)("term",r.filterAll.value),e.xp6(1),e.Q6J("result",t.apaterno)("term",r.filterAll.value),e.xp6(1),e.Q6J("result",t.amaterno)("term",r.filterAll.value),e.xp6(2),e.Q6J("result",t.email)("term",r.filterAll.value),e.xp6(2),e.Q6J("result",null==t.roles?null:t.roles.nombre)("term",r.filterAll.value)}}function se(s,i){if(1&s&&(e.TgZ(0,"tbody"),e.YNc(1,te,18,13,"tr",18),e.ALo(2,"slice"),e.ALo(3,"async"),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.Dn7(2,1,e.lcZ(3,5,t.source$),(t.page-1)*t.pageSize,t.page*t.pageSize))}}function re(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"div",10)(2,"div",11)(3,"table",12)(4,"thead",13)(5,"tr")(6,"th",14)(7,"div",15),e._uU(8,"#"),e.qZA()(),e.TgZ(9,"th",14)(10,"div",15),e._uU(11,"Usuario"),e.qZA()(),e.TgZ(12,"th",14)(13,"div",15),e._uU(14,"Nombre"),e.qZA()(),e.TgZ(15,"th",14)(16,"div",15),e._uU(17,"Correo"),e.qZA()(),e.TgZ(18,"th",14)(19,"div",15),e._uU(20,"Rol"),e.qZA()(),e.TgZ(21,"th",14)(22,"div",15),e._uU(23,"Gesti\xf3n"),e.qZA()()()(),e.YNc(24,ee,3,0,"tbody",8),e.ALo(25,"async"),e.YNc(26,se,4,7,"tbody",8),e.ALo(27,"async"),e.qZA()()(),e.TgZ(28,"div",10)(29,"ngb-pagination",16),e.NdJ("pageChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.page=n)}),e.ALo(30,"async"),e.qZA()()()}if(2&s){const t=e.oxw();let r,n,o;e.xp6(24),e.Q6J("ngIf",0==(null==(r=e.lcZ(25,6,t.source$))?null:r.length)),e.xp6(2),e.Q6J("ngIf",0!==(null==(n=e.lcZ(27,8,t.source$))?null:n.length)),e.xp6(3),e.Q6J("collectionSize",null!==(o=null==(o=e.lcZ(30,10,t.source$))?null:o.length)&&void 0!==o?o:0)("page",t.page)("pageSize",t.pageSize)("maxSize",2)}}const ne=[{path:"users",component:(()=>{class s{constructor(t,r,n,o){this.modalService=t,this._getUserUseCases=r,this._updateUserUseCases=n,this.USERS=[],this.page=0,this.pageSize=10,this.filterName=new a.NI("",{nonNullable:!0}),this.filterAll=new a.NI("",{nonNullable:!0}),this.fields={nombre:"",email:""},this.filter1={},this.filter2={},this.pipe=o,this.isReady=!1}ngOnInit(){this.getAllUsers()}getAllUsers(){this._getUserUseCases.getAll().subscribe(r=>{r.forEach((n,o)=>{n.idList=o+1}),this.USERS=r,this.isReady=!0,this.source$=this.filterAll.valueChanges.pipe((0,m.O)(""),(0,g.U)(n=>this.search(n,this.pipe)))})}open(t){const r=this.modalService.open(W,{fullscreen:"xl"});r.componentInstance.userId=t,r.result.then(()=>{},n=>{this.isReady=!1,this.getAllUsers()})}updateFilters(){Object.keys(this.fields).forEach(t=>""===this.fields[t]?delete this.fields[t]:t),this.filter2=Object.assign({},this.fields)}search(t,r){return this.USERS.filter(n=>{const o=t.toLowerCase();return r.transform(n.id).includes(o)||n.username.toLowerCase().includes(o)||n.nombre.toLowerCase().includes(o)||n.apaterno.toLowerCase().includes(o)||n.amaterno.toLowerCase().includes(o)||n.email.toLowerCase().includes(o)})}deleteById(t){d().fire({text:"\xbfDesea eliminar el usuario?",title:"Eliminar Usuario",showCancelButton:!0,confirmButtonText:"Confirmar",cancelButtonText:"Cancelar",reverseButtons:!0,showCloseButton:!0}).then(r=>{r.isConfirmed&&this._updateUserUseCases.update({amaterno:t.amaterno,apaterno:t.apaterno,email:t.email,nombre:t.nombre,username:t.username,id:t.id,roles:t.roles,activo:!1}).subscribe({next:l=>{d().close(),this.isReady=!0,d().fire("","\xa1Usuario eliminado exitosamente!","success"),this.isReady=!1,this.getAllUsers()},error:l=>{d().close(),0==l.status&&d().fire("","Validar servicio activo","error")}})})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(h.FF),e.Y36(U),e.Y36(Z),e.Y36(c.JJ))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-users"]],features:[e._Bn([c.JJ])],decls:12,vars:4,consts:[[3,"showBack"],["title","Registro de usuarios"],[1,"d-flex","flex-row","justify-content-between"],[1,"d-flex","mt-auto","p-2","flex-row","align-items-center","w-100"],["for","search",1,"p-2"],["type","text",1,"form-control",3,"formControl"],[1,"p-2","w-100","justify-content-end","d-flex"],["type","button","routerLink","/users-management/users-new",1,"btn","btn-primary"],[4,"ngIf"],["alt","Logo",1,"img-logo",2,"height","100%",3,"src"],[1,"d-flex","flex-column","align-items-end"],[1,"col-12","table-responsive"],["aria-describedby","Listado de usuarios",1,"table","table-bordered","table-striped"],[1,"thead-inverse","table-header"],["scope","col"],[1,"col-12"],[1,"mt-auto","p-2",3,"collectionSize","page","pageSize","maxSize","pageChange"],["colspan","5"],[4,"ngFor","ngForOf"],[3,"result","term"],[1,"mx-1",3,"result","term"],[1,"btn","btn-link",3,"click"],[1,"bi","bi-pencil"],[1,"bi","bi-x-circle","text-danger"]],template:function(t,r){1&t&&(e.TgZ(0,"app-base",0)(1,"app-card",1)(2,"div",2)(3,"div",3)(4,"label",4),e._uU(5,"Buscar:"),e.qZA(),e._UZ(6,"input",5),e.qZA(),e.TgZ(7,"div",6)(8,"button",7),e._uU(9," Nuevo Usuario "),e.qZA()()(),e.YNc(10,X,2,1,"div",8),e.YNc(11,re,31,12,"div",8),e.qZA()()),2&t&&(e.Q6J("showBack",!0),e.xp6(6),e.Q6J("formControl",r.filterAll),e.xp6(4),e.Q6J("ngIf",!r.isReady),e.xp6(1),e.Q6J("ngIf",r.isReady))},dependencies:[c.sg,c.O5,T.H,_.rH,h.N9,h._h,a.Fj,a.JJ,a.oH,v,c.Ov,c.OU],encapsulation:2}),s})()},{path:"users-new",component:B}];let oe=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[_.Bz.forChild(ne),_.Bz]}),s})();var ie=u(8522);let ae=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[c.ez,ie.BaseModule,oe,h.IJ,a.UX,a.u5]}),s})()}}]);